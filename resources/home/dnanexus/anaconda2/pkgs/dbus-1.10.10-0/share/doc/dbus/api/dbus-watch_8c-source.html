<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>D-Bus: dbus-watch.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1>dbus-watch.c</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* -*- mode: C; c-file-style: "gnu"; indent-tabs-mode: nil; -*- */</span>
<a name="l00002"></a>00002 <span class="comment">/* dbus-watch.c DBusWatch implementation</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Copyright (C) 2002, 2003  Red Hat Inc.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * Licensed under the Academic Free License version 2.1</span>
<a name="l00007"></a>00007 <span class="comment"> * </span>
<a name="l00008"></a>00008 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00009"></a>00009 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l00010"></a>00010 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00011"></a>00011 <span class="comment"> * (at your option) any later version.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00014"></a>00014 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00015"></a>00015 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00016"></a>00016 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00017"></a>00017 <span class="comment"> * </span>
<a name="l00018"></a>00018 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00019"></a>00019 <span class="comment"> * along with this program; if not, write to the Free Software</span>
<a name="l00020"></a>00020 <span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> */</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;config.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include "dbus-internals.h"</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include "dbus-watch.h"</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include "dbus-list.h"</span>
<a name="l00028"></a>00028 
<a name="l00040"></a><a class="code" href="structDBusWatch.html">00040</a> <span class="keyword">struct </span><a class="code" href="structDBusWatch.html">DBusWatch</a>
<a name="l00041"></a>00041 {
<a name="l00042"></a><a class="code" href="structDBusWatch.html#3984cbcb64ed76d2f0c1182c386f7978">00042</a>   <span class="keywordtype">int</span> <a class="code" href="structDBusWatch.html#3984cbcb64ed76d2f0c1182c386f7978">refcount</a>;                        
<a name="l00043"></a><a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">00043</a>   <a class="code" href="group__DBusSysdeps.html#ge217564e8ab50848f04003d982287661">DBusPollable</a> <a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>;                     
<a name="l00044"></a><a class="code" href="structDBusWatch.html#7f1c2c609410f58a2328681c2893f70a">00044</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structDBusWatch.html#7f1c2c609410f58a2328681c2893f70a">flags</a>;                  
<a name="l00046"></a><a class="code" href="structDBusWatch.html#ad3fb97da0ad7e5897611930f7a1c3e9">00046</a>   <a class="code" href="group__DBusWatchInternals.html#gcc4276cd0b01ed7c011658f164ce575a">DBusWatchHandler</a> <a class="code" href="structDBusWatch.html#ad3fb97da0ad7e5897611930f7a1c3e9">handler</a>;                    
<a name="l00047"></a><a class="code" href="structDBusWatch.html#e906b28caa8a4323f85c882abe901e87">00047</a>   <span class="keywordtype">void</span> *<a class="code" href="structDBusWatch.html#e906b28caa8a4323f85c882abe901e87">handler_data</a>;                          
<a name="l00048"></a><a class="code" href="structDBusWatch.html#64eaf9b88cebfc640bc85d0fd37184c8">00048</a>   <a class="code" href="group__DBusMemory.html#g8792ec2b2b8626ca28022faf51ec415a">DBusFreeFunction</a> <a class="code" href="structDBusWatch.html#64eaf9b88cebfc640bc85d0fd37184c8">free_handler_data_function</a>; 
<a name="l00050"></a><a class="code" href="structDBusWatch.html#71877a39d8c2a7d533c0c6f280648d53">00050</a>   <span class="keywordtype">void</span> *<a class="code" href="structDBusWatch.html#71877a39d8c2a7d533c0c6f280648d53">data</a>;                          
<a name="l00051"></a><a class="code" href="structDBusWatch.html#d848cbd636518fd346039d0d771ba021">00051</a>   <a class="code" href="group__DBusMemory.html#g8792ec2b2b8626ca28022faf51ec415a">DBusFreeFunction</a> <a class="code" href="structDBusWatch.html#d848cbd636518fd346039d0d771ba021">free_data_function</a>; 
<a name="l00052"></a><a class="code" href="structDBusWatch.html#010564b43e0c7dd438b9ac4b0c1dbe64">00052</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structDBusWatch.html#010564b43e0c7dd438b9ac4b0c1dbe64">enabled</a> : 1;            
<a name="l00053"></a><a class="code" href="structDBusWatch.html#1020150c9fd9764ac85919d2c48bb6e1">00053</a>   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structDBusWatch.html#1020150c9fd9764ac85919d2c48bb6e1">oom_last_time</a> : 1;      
<a name="l00054"></a>00054 };
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <a class="code" href="group__DBusTypes.html#g39c9cb0f3a2a8ad6f55cc4855d035349">dbus_bool_t</a>
<a name="l00057"></a><a class="code" href="group__DBusWatchInternals.html#g7dcad11a2e5588c0a36e43a599bc9f4d">00057</a> <a class="code" href="group__DBusWatchInternals.html#g7dcad11a2e5588c0a36e43a599bc9f4d">_dbus_watch_get_enabled</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00058"></a>00058 {
<a name="l00059"></a>00059   <span class="keywordflow">return</span> watch-&gt;<a class="code" href="structDBusWatch.html#010564b43e0c7dd438b9ac4b0c1dbe64">enabled</a>;
<a name="l00060"></a>00060 }
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <a class="code" href="group__DBusTypes.html#g39c9cb0f3a2a8ad6f55cc4855d035349">dbus_bool_t</a>
<a name="l00063"></a><a class="code" href="group__DBusWatchInternals.html#g71767cd6825b87386b955c2fae95ab76">00063</a> <a class="code" href="group__DBusWatchInternals.html#g71767cd6825b87386b955c2fae95ab76">_dbus_watch_get_oom_last_time</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00064"></a>00064 {
<a name="l00065"></a>00065   <span class="keywordflow">return</span> watch-&gt;<a class="code" href="structDBusWatch.html#1020150c9fd9764ac85919d2c48bb6e1">oom_last_time</a>;
<a name="l00066"></a>00066 }
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="keywordtype">void</span>
<a name="l00069"></a><a class="code" href="group__DBusWatchInternals.html#g662f1a85094dcabde932f623afff8a75">00069</a> <a class="code" href="group__DBusWatchInternals.html#g662f1a85094dcabde932f623afff8a75">_dbus_watch_set_oom_last_time</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a>   *watch,
<a name="l00070"></a>00070                                <a class="code" href="group__DBusTypes.html#g39c9cb0f3a2a8ad6f55cc4855d035349">dbus_bool_t</a>  oom)
<a name="l00071"></a>00071 {
<a name="l00072"></a>00072   watch-&gt;<a class="code" href="structDBusWatch.html#1020150c9fd9764ac85919d2c48bb6e1">oom_last_time</a> = oom;
<a name="l00073"></a>00073 }
<a name="l00074"></a>00074 
<a name="l00087"></a>00087 <a class="code" href="structDBusWatch.html">DBusWatch</a>*
<a name="l00088"></a><a class="code" href="group__DBusWatchInternals.html#gc4ff38c7e9e6cc21f79aa2bc4fa67d3d">00088</a> <a class="code" href="group__DBusWatchInternals.html#gc4ff38c7e9e6cc21f79aa2bc4fa67d3d">_dbus_watch_new</a> (<a class="code" href="group__DBusSysdeps.html#ge217564e8ab50848f04003d982287661">DBusPollable</a>      fd,
<a name="l00089"></a>00089                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>      flags,
<a name="l00090"></a>00090                  <a class="code" href="group__DBusTypes.html#g39c9cb0f3a2a8ad6f55cc4855d035349">dbus_bool_t</a>       enabled,
<a name="l00091"></a>00091                  <a class="code" href="group__DBusWatchInternals.html#gcc4276cd0b01ed7c011658f164ce575a">DBusWatchHandler</a>  handler,
<a name="l00092"></a>00092                  <span class="keywordtype">void</span>             *data,
<a name="l00093"></a>00093                  <a class="code" href="group__DBusMemory.html#g8792ec2b2b8626ca28022faf51ec415a">DBusFreeFunction</a>  free_data_function)
<a name="l00094"></a>00094 {
<a name="l00095"></a>00095   <a class="code" href="structDBusWatch.html">DBusWatch</a> *watch;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="preprocessor">#define VALID_WATCH_FLAGS (DBUS_WATCH_WRITABLE | DBUS_WATCH_READABLE)</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>  
<a name="l00099"></a>00099   <a class="code" href="group__DBusInternalsUtils.html#g129c6c03f011cdc171934d5d386cc797">_dbus_assert</a> ((flags &amp; VALID_WATCH_FLAGS) == flags);
<a name="l00100"></a>00100   
<a name="l00101"></a>00101   watch = <a class="code" href="group__DBusMemory.html#gba9d823abda7f4cadbaf5177d3b8b793">dbus_new0</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a>, 1);
<a name="l00102"></a>00102   <span class="keywordflow">if</span> (watch == <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00103"></a>00103     <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00104"></a>00104   
<a name="l00105"></a>00105   watch-&gt;<a class="code" href="structDBusWatch.html#3984cbcb64ed76d2f0c1182c386f7978">refcount</a> = 1;
<a name="l00106"></a>00106   watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a> = fd;
<a name="l00107"></a>00107   watch-&gt;<a class="code" href="structDBusWatch.html#7f1c2c609410f58a2328681c2893f70a">flags</a> = flags;
<a name="l00108"></a>00108   watch-&gt;<a class="code" href="structDBusWatch.html#010564b43e0c7dd438b9ac4b0c1dbe64">enabled</a> = enabled;
<a name="l00109"></a>00109 
<a name="l00110"></a>00110   watch-&gt;<a class="code" href="structDBusWatch.html#ad3fb97da0ad7e5897611930f7a1c3e9">handler</a> = handler;
<a name="l00111"></a>00111   watch-&gt;<a class="code" href="structDBusWatch.html#e906b28caa8a4323f85c882abe901e87">handler_data</a> = data;
<a name="l00112"></a>00112   watch-&gt;<a class="code" href="structDBusWatch.html#64eaf9b88cebfc640bc85d0fd37184c8">free_handler_data_function</a> = free_data_function;
<a name="l00113"></a>00113   
<a name="l00114"></a>00114   <span class="keywordflow">return</span> watch;
<a name="l00115"></a>00115 }
<a name="l00116"></a>00116 
<a name="l00123"></a>00123 <a class="code" href="structDBusWatch.html">DBusWatch</a> *
<a name="l00124"></a><a class="code" href="group__DBusWatchInternals.html#gceda03acdda228e66a5cfe96126a919b">00124</a> <a class="code" href="group__DBusWatchInternals.html#gceda03acdda228e66a5cfe96126a919b">_dbus_watch_ref</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00125"></a>00125 {
<a name="l00126"></a>00126   watch-&gt;<a class="code" href="structDBusWatch.html#3984cbcb64ed76d2f0c1182c386f7978">refcount</a> += 1;
<a name="l00127"></a>00127 
<a name="l00128"></a>00128   <span class="keywordflow">return</span> watch;
<a name="l00129"></a>00129 }
<a name="l00130"></a>00130 
<a name="l00137"></a>00137 <span class="keywordtype">void</span>
<a name="l00138"></a><a class="code" href="group__DBusWatchInternals.html#gdd0e6a682b67e470bdb77f2c8da5baea">00138</a> <a class="code" href="group__DBusWatchInternals.html#gdd0e6a682b67e470bdb77f2c8da5baea">_dbus_watch_unref</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140   <a class="code" href="group__DBusInternalsUtils.html#g129c6c03f011cdc171934d5d386cc797">_dbus_assert</a> (watch != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00141"></a>00141   <a class="code" href="group__DBusInternalsUtils.html#g129c6c03f011cdc171934d5d386cc797">_dbus_assert</a> (watch-&gt;<a class="code" href="structDBusWatch.html#3984cbcb64ed76d2f0c1182c386f7978">refcount</a> &gt; 0);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143   watch-&gt;<a class="code" href="structDBusWatch.html#3984cbcb64ed76d2f0c1182c386f7978">refcount</a> -= 1;
<a name="l00144"></a>00144   <span class="keywordflow">if</span> (watch-&gt;<a class="code" href="structDBusWatch.html#3984cbcb64ed76d2f0c1182c386f7978">refcount</a> == 0)
<a name="l00145"></a>00145     {
<a name="l00146"></a>00146       <span class="keywordflow">if</span> (_dbus_pollable_is_valid (watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>))
<a name="l00147"></a>00147         <a class="code" href="group__DBusInternalsUtils.html#gbea2c16d6d3fe7c4eb5b9496fc877f84">_dbus_warn</a> (<span class="stringliteral">"this watch should have been invalidated"</span>);
<a name="l00148"></a>00148 
<a name="l00149"></a>00149       <a class="code" href="group__DBusWatch.html#g5c75a65cf0680956cc0188d86a05cfae">dbus_watch_set_data</a> (watch, <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>); <span class="comment">/* call free_data_function */</span>
<a name="l00150"></a>00150 
<a name="l00151"></a>00151       <span class="keywordflow">if</span> (watch-&gt;<a class="code" href="structDBusWatch.html#64eaf9b88cebfc640bc85d0fd37184c8">free_handler_data_function</a>)
<a name="l00152"></a>00152         (* watch-&gt;<a class="code" href="structDBusWatch.html#64eaf9b88cebfc640bc85d0fd37184c8">free_handler_data_function</a>) (watch-&gt;<a class="code" href="structDBusWatch.html#e906b28caa8a4323f85c882abe901e87">handler_data</a>);
<a name="l00153"></a>00153       
<a name="l00154"></a>00154       <a class="code" href="group__DBusMemory.html#g34e666b19b015035a9a31e53da84b39a">dbus_free</a> (watch);
<a name="l00155"></a>00155     }
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 
<a name="l00168"></a>00168 <span class="keywordtype">void</span>
<a name="l00169"></a><a class="code" href="group__DBusWatchInternals.html#ged53379a4f88fdb7025f0c6d0bcb76f5">00169</a> <a class="code" href="group__DBusWatchInternals.html#ged53379a4f88fdb7025f0c6d0bcb76f5">_dbus_watch_invalidate</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00170"></a>00170 {
<a name="l00171"></a>00171   _dbus_pollable_invalidate (&amp;watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>);
<a name="l00172"></a>00172   watch-&gt;<a class="code" href="structDBusWatch.html#7f1c2c609410f58a2328681c2893f70a">flags</a> = 0;
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00184"></a>00184 <span class="keywordtype">void</span>
<a name="l00185"></a><a class="code" href="group__DBusWatchInternals.html#gb8f49926fe9ee56cb4ae7c1c8071cca3">00185</a> <a class="code" href="group__DBusWatchInternals.html#gb8f49926fe9ee56cb4ae7c1c8071cca3">_dbus_watch_sanitize_condition</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a>    *watch,
<a name="l00186"></a>00186                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *condition)
<a name="l00187"></a>00187 {
<a name="l00188"></a>00188   <span class="keywordflow">if</span> (!(watch-&gt;<a class="code" href="structDBusWatch.html#7f1c2c609410f58a2328681c2893f70a">flags</a> &amp; <a class="code" href="group__DBusConnection.html#gg0556779e61aeb19eb9cf6b6466bd1b98178bd7a88e9bfbb8505db76eb7e0ccc4">DBUS_WATCH_READABLE</a>))
<a name="l00189"></a>00189     *condition &amp;= ~<a class="code" href="group__DBusConnection.html#gg0556779e61aeb19eb9cf6b6466bd1b98178bd7a88e9bfbb8505db76eb7e0ccc4">DBUS_WATCH_READABLE</a>;
<a name="l00190"></a>00190   <span class="keywordflow">if</span> (!(watch-&gt;<a class="code" href="structDBusWatch.html#7f1c2c609410f58a2328681c2893f70a">flags</a> &amp; <a class="code" href="group__DBusConnection.html#gg0556779e61aeb19eb9cf6b6466bd1b9862ddca29b06bfbbc08bb7f3dfd3d307f">DBUS_WATCH_WRITABLE</a>))
<a name="l00191"></a>00191     *condition &amp;= ~<a class="code" href="group__DBusConnection.html#gg0556779e61aeb19eb9cf6b6466bd1b9862ddca29b06bfbbc08bb7f3dfd3d307f">DBUS_WATCH_WRITABLE</a>;
<a name="l00192"></a>00192 }
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 
<a name="l00214"></a><a class="code" href="structDBusWatchList.html">00214</a> <span class="keyword">struct </span><a class="code" href="structDBusWatchList.html">DBusWatchList</a>
<a name="l00215"></a>00215 {
<a name="l00216"></a><a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">00216</a>   <a class="code" href="structDBusList.html">DBusList</a> *<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>;           
<a name="l00218"></a><a class="code" href="structDBusWatchList.html#e515ab01e8d08e6b252e468be7dc7074">00218</a>   <a class="code" href="group__DBusConnection.html#g985b712fc165afa66e5901859b68b9de">DBusAddWatchFunction</a> <a class="code" href="structDBusWatchList.html#e515ab01e8d08e6b252e468be7dc7074">add_watch_function</a>;    
<a name="l00219"></a><a class="code" href="structDBusWatchList.html#3b4b6c6d8aeb77d9b08404575e0b805a">00219</a>   <a class="code" href="group__DBusConnection.html#g6a48c42c4bde24911cae7fda0d1f1589">DBusRemoveWatchFunction</a> <a class="code" href="structDBusWatchList.html#3b4b6c6d8aeb77d9b08404575e0b805a">remove_watch_function</a>; 
<a name="l00220"></a><a class="code" href="structDBusWatchList.html#ed21ba690eb810c4c2da581feaed822a">00220</a>   <a class="code" href="group__DBusConnection.html#gfa7e0f7856f8ebbe66475979ef54ed9e">DBusWatchToggledFunction</a> <a class="code" href="structDBusWatchList.html#ed21ba690eb810c4c2da581feaed822a">watch_toggled_function</a>; 
<a name="l00221"></a><a class="code" href="structDBusWatchList.html#767770241baf8ddcdb4b5c4b4f2a9727">00221</a>   <span class="keywordtype">void</span> *<a class="code" href="structDBusWatchList.html#767770241baf8ddcdb4b5c4b4f2a9727">watch_data</a>;                           
<a name="l00222"></a><a class="code" href="structDBusWatchList.html#2308b08f7f4cb858fbcca718f2bef735">00222</a>   <a class="code" href="group__DBusMemory.html#g8792ec2b2b8626ca28022faf51ec415a">DBusFreeFunction</a> <a class="code" href="structDBusWatchList.html#2308b08f7f4cb858fbcca718f2bef735">watch_free_data_function</a>;  
<a name="l00223"></a>00223 };
<a name="l00224"></a>00224 
<a name="l00231"></a>00231 <a class="code" href="structDBusWatchList.html">DBusWatchList</a>*
<a name="l00232"></a><a class="code" href="group__DBusWatchInternals.html#g19c761997dbbf753c826389c7950d3eb">00232</a> <a class="code" href="group__DBusWatchInternals.html#g19c761997dbbf753c826389c7950d3eb">_dbus_watch_list_new</a> (<span class="keywordtype">void</span>)
<a name="l00233"></a>00233 {
<a name="l00234"></a>00234   <a class="code" href="structDBusWatchList.html">DBusWatchList</a> *watch_list;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236   watch_list = <a class="code" href="group__DBusMemory.html#gba9d823abda7f4cadbaf5177d3b8b793">dbus_new0</a> (<a class="code" href="structDBusWatchList.html">DBusWatchList</a>, 1);
<a name="l00237"></a>00237   <span class="keywordflow">if</span> (watch_list == <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00238"></a>00238     <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00239"></a>00239 
<a name="l00240"></a>00240   <span class="keywordflow">return</span> watch_list;
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00248"></a>00248 <span class="keywordtype">void</span>
<a name="l00249"></a><a class="code" href="group__DBusWatchInternals.html#g1fe225c4194c30dfe54be322e8519da5">00249</a> <a class="code" href="group__DBusWatchInternals.html#g1fe225c4194c30dfe54be322e8519da5">_dbus_watch_list_free</a> (<a class="code" href="structDBusWatchList.html">DBusWatchList</a> *watch_list)
<a name="l00250"></a>00250 {
<a name="l00251"></a>00251   <span class="comment">/* free watch_data and removes watches as a side effect */</span>
<a name="l00252"></a>00252   <a class="code" href="group__DBusWatchInternals.html#g68093be43e77210613abc4024ed5100e">_dbus_watch_list_set_functions</a> (watch_list,
<a name="l00253"></a>00253                                   <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00254"></a>00254   <a class="code" href="group__DBusList.html#g8dd69084b53361803a765e6d53d5b9d1">_dbus_list_foreach</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>,
<a name="l00255"></a>00255                       (<a class="code" href="group__DBusInternalsUtils.html#gadf9d45082dd1c9f59d8420d13492669">DBusForeachFunction</a>) <a class="code" href="group__DBusWatchInternals.html#gdd0e6a682b67e470bdb77f2c8da5baea">_dbus_watch_unref</a>,
<a name="l00256"></a>00256                       <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00257"></a>00257   <a class="code" href="group__DBusList.html#ga36d13444a050a923941c53650b72f9d">_dbus_list_clear</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>);
<a name="l00258"></a>00258 
<a name="l00259"></a>00259   <a class="code" href="group__DBusMemory.html#g34e666b19b015035a9a31e53da84b39a">dbus_free</a> (watch_list);
<a name="l00260"></a>00260 }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="preprocessor">#ifdef DBUS_ENABLE_VERBOSE_MODE</span>
<a name="l00263"></a>00263 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>*
<a name="l00264"></a>00264 watch_flags_to_string (<span class="keywordtype">int</span> flags)
<a name="l00265"></a>00265 {
<a name="l00266"></a>00266   <span class="keyword">const</span> <span class="keywordtype">char</span> *watch_type;
<a name="l00267"></a>00267 
<a name="l00268"></a>00268   <span class="keywordflow">if</span> ((flags &amp; <a class="code" href="group__DBusConnection.html#gg0556779e61aeb19eb9cf6b6466bd1b98178bd7a88e9bfbb8505db76eb7e0ccc4">DBUS_WATCH_READABLE</a>) &amp;&amp;
<a name="l00269"></a>00269       (flags &amp; <a class="code" href="group__DBusConnection.html#gg0556779e61aeb19eb9cf6b6466bd1b9862ddca29b06bfbbc08bb7f3dfd3d307f">DBUS_WATCH_WRITABLE</a>))
<a name="l00270"></a>00270     watch_type = <span class="stringliteral">"readwrite"</span>;
<a name="l00271"></a>00271   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flags &amp; DBUS_WATCH_READABLE)
<a name="l00272"></a>00272     watch_type = <span class="stringliteral">"read"</span>;
<a name="l00273"></a>00273   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flags &amp; DBUS_WATCH_WRITABLE)
<a name="l00274"></a>00274     watch_type = <span class="stringliteral">"write"</span>;
<a name="l00275"></a>00275   <span class="keywordflow">else</span>
<a name="l00276"></a>00276     watch_type = <span class="stringliteral">"not read or write"</span>;
<a name="l00277"></a>00277   <span class="keywordflow">return</span> watch_type;
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279 <span class="preprocessor">#endif </span><span class="comment">/* DBUS_ENABLE_VERBOSE_MODE */</span>
<a name="l00280"></a>00280 
<a name="l00295"></a>00295 <a class="code" href="group__DBusTypes.html#g39c9cb0f3a2a8ad6f55cc4855d035349">dbus_bool_t</a>
<a name="l00296"></a><a class="code" href="group__DBusWatchInternals.html#g68093be43e77210613abc4024ed5100e">00296</a> <a class="code" href="group__DBusWatchInternals.html#g68093be43e77210613abc4024ed5100e">_dbus_watch_list_set_functions</a> (<a class="code" href="structDBusWatchList.html">DBusWatchList</a>           *watch_list,
<a name="l00297"></a>00297                                 <a class="code" href="group__DBusConnection.html#g985b712fc165afa66e5901859b68b9de">DBusAddWatchFunction</a>     add_function,
<a name="l00298"></a>00298                                 <a class="code" href="group__DBusConnection.html#g6a48c42c4bde24911cae7fda0d1f1589">DBusRemoveWatchFunction</a>  remove_function,
<a name="l00299"></a>00299                                 <a class="code" href="group__DBusConnection.html#gfa7e0f7856f8ebbe66475979ef54ed9e">DBusWatchToggledFunction</a> toggled_function,
<a name="l00300"></a>00300                                 <span class="keywordtype">void</span>                    *data,
<a name="l00301"></a>00301                                 <a class="code" href="group__DBusMemory.html#g8792ec2b2b8626ca28022faf51ec415a">DBusFreeFunction</a>         free_data_function)
<a name="l00302"></a>00302 {
<a name="l00303"></a>00303   <span class="comment">/* Add watches with the new watch function, failing on OOM */</span>
<a name="l00304"></a>00304   <span class="keywordflow">if</span> (add_function != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00305"></a>00305     {
<a name="l00306"></a>00306       <a class="code" href="structDBusList.html">DBusList</a> *link;
<a name="l00307"></a>00307       
<a name="l00308"></a>00308       link = <a class="code" href="group__DBusList.html#g1e26ce4fb4acb50593bd5ed2f4eeb3ae">_dbus_list_get_first_link</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>);
<a name="l00309"></a>00309       <span class="keywordflow">while</span> (link != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00310"></a>00310         {
<a name="l00311"></a>00311           <a class="code" href="structDBusList.html">DBusList</a> *next = <a class="code" href="group__DBusList.html#gede4ace46d5ee497d75074bfec4490a2">_dbus_list_get_next_link</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>,
<a name="l00312"></a>00312                                                      link);
<a name="l00313"></a>00313 <span class="preprocessor">#ifdef DBUS_ENABLE_VERBOSE_MODE</span>
<a name="l00314"></a>00314 <span class="preprocessor"></span>          <a class="code" href="structDBusWatch.html">DBusWatch</a> *watch = link-&gt;<a class="code" href="structDBusList.html#29ab457bcf9092252bb0c4282c727055">data</a>;
<a name="l00315"></a>00315 
<a name="l00316"></a>00316           _dbus_verbose (<span class="stringliteral">"Adding a %s watch on fd %"</span> <a class="code" href="group__DBusSysdeps.html#gd448c8ded79d55a3ca694d6aa9fa24cb">DBUS_POLLABLE_FORMAT</a> <span class="stringliteral">" using newly-set add watch function\n"</span>,
<a name="l00317"></a>00317                          watch_flags_to_string (<a class="code" href="group__DBusWatch.html#gf172a2b1d1f82333e67cec8d99c9204a">dbus_watch_get_flags</a> (link-&gt;<a class="code" href="structDBusList.html#29ab457bcf9092252bb0c4282c727055">data</a>)),
<a name="l00318"></a>00318                          _dbus_pollable_printable (watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>));
<a name="l00319"></a>00319 <span class="preprocessor">#endif</span>
<a name="l00320"></a>00320 <span class="preprocessor"></span>          
<a name="l00321"></a>00321           <span class="keywordflow">if</span> (!(* add_function) (link-&gt;<a class="code" href="structDBusList.html#29ab457bcf9092252bb0c4282c727055">data</a>, data))
<a name="l00322"></a>00322             {
<a name="l00323"></a>00323               <span class="comment">/* remove it all again and return FALSE */</span>
<a name="l00324"></a>00324               <a class="code" href="structDBusList.html">DBusList</a> *link2;
<a name="l00325"></a>00325               
<a name="l00326"></a>00326               link2 = <a class="code" href="group__DBusList.html#g1e26ce4fb4acb50593bd5ed2f4eeb3ae">_dbus_list_get_first_link</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>);
<a name="l00327"></a>00327               <span class="keywordflow">while</span> (link2 != link)
<a name="l00328"></a>00328                 {
<a name="l00329"></a>00329                   <a class="code" href="structDBusList.html">DBusList</a> *next = <a class="code" href="group__DBusList.html#gede4ace46d5ee497d75074bfec4490a2">_dbus_list_get_next_link</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>,
<a name="l00330"></a>00330                                                              link2);
<a name="l00331"></a>00331 <span class="preprocessor">#ifdef DBUS_ENABLE_VERBOSE_MODE</span>
<a name="l00332"></a>00332 <span class="preprocessor"></span>                  <a class="code" href="structDBusWatch.html">DBusWatch</a> *watch2 = link2-&gt;<a class="code" href="structDBusList.html#29ab457bcf9092252bb0c4282c727055">data</a>;
<a name="l00333"></a>00333                   
<a name="l00334"></a>00334                   _dbus_verbose (<span class="stringliteral">"Removing watch on fd %"</span> <a class="code" href="group__DBusSysdeps.html#gd448c8ded79d55a3ca694d6aa9fa24cb">DBUS_POLLABLE_FORMAT</a> <span class="stringliteral">" using newly-set remove function because initial add failed\n"</span>,
<a name="l00335"></a>00335                                  _dbus_pollable_printable (watch2-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>));
<a name="l00336"></a>00336 <span class="preprocessor">#endif</span>
<a name="l00337"></a>00337 <span class="preprocessor"></span>                  
<a name="l00338"></a>00338                   (* remove_function) (link2-&gt;<a class="code" href="structDBusList.html#29ab457bcf9092252bb0c4282c727055">data</a>, data);
<a name="l00339"></a>00339                   
<a name="l00340"></a>00340                   link2 = next;
<a name="l00341"></a>00341                 }
<a name="l00342"></a>00342 
<a name="l00343"></a>00343               <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00344"></a>00344             }
<a name="l00345"></a>00345       
<a name="l00346"></a>00346           link = next;
<a name="l00347"></a>00347         }
<a name="l00348"></a>00348     }
<a name="l00349"></a>00349   
<a name="l00350"></a>00350   <span class="comment">/* Remove all current watches from previous watch handlers */</span>
<a name="l00351"></a>00351 
<a name="l00352"></a>00352   <span class="keywordflow">if</span> (watch_list-&gt;<a class="code" href="structDBusWatchList.html#3b4b6c6d8aeb77d9b08404575e0b805a">remove_watch_function</a> != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00353"></a>00353     {
<a name="l00354"></a>00354       _dbus_verbose (<span class="stringliteral">"Removing all pre-existing watches\n"</span>);
<a name="l00355"></a>00355       
<a name="l00356"></a>00356       <a class="code" href="group__DBusList.html#g8dd69084b53361803a765e6d53d5b9d1">_dbus_list_foreach</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>,
<a name="l00357"></a>00357                           (<a class="code" href="group__DBusInternalsUtils.html#gadf9d45082dd1c9f59d8420d13492669">DBusForeachFunction</a>) watch_list-&gt;<a class="code" href="structDBusWatchList.html#3b4b6c6d8aeb77d9b08404575e0b805a">remove_watch_function</a>,
<a name="l00358"></a>00358                           watch_list-&gt;<a class="code" href="structDBusWatchList.html#767770241baf8ddcdb4b5c4b4f2a9727">watch_data</a>);
<a name="l00359"></a>00359     }
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   <span class="keywordflow">if</span> (watch_list-&gt;<a class="code" href="structDBusWatchList.html#2308b08f7f4cb858fbcca718f2bef735">watch_free_data_function</a> != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00362"></a>00362     (* watch_list-&gt;<a class="code" href="structDBusWatchList.html#2308b08f7f4cb858fbcca718f2bef735">watch_free_data_function</a>) (watch_list-&gt;<a class="code" href="structDBusWatchList.html#767770241baf8ddcdb4b5c4b4f2a9727">watch_data</a>);
<a name="l00363"></a>00363   
<a name="l00364"></a>00364   watch_list-&gt;<a class="code" href="structDBusWatchList.html#e515ab01e8d08e6b252e468be7dc7074">add_watch_function</a> = add_function;
<a name="l00365"></a>00365   watch_list-&gt;<a class="code" href="structDBusWatchList.html#3b4b6c6d8aeb77d9b08404575e0b805a">remove_watch_function</a> = remove_function;
<a name="l00366"></a>00366   watch_list-&gt;<a class="code" href="structDBusWatchList.html#ed21ba690eb810c4c2da581feaed822a">watch_toggled_function</a> = toggled_function;
<a name="l00367"></a>00367   watch_list-&gt;<a class="code" href="structDBusWatchList.html#767770241baf8ddcdb4b5c4b4f2a9727">watch_data</a> = data;
<a name="l00368"></a>00368   watch_list-&gt;<a class="code" href="structDBusWatchList.html#2308b08f7f4cb858fbcca718f2bef735">watch_free_data_function</a> = free_data_function;
<a name="l00369"></a>00369 
<a name="l00370"></a>00370   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00371"></a>00371 }
<a name="l00372"></a>00372 
<a name="l00381"></a>00381 <a class="code" href="group__DBusTypes.html#g39c9cb0f3a2a8ad6f55cc4855d035349">dbus_bool_t</a>
<a name="l00382"></a><a class="code" href="group__DBusWatchInternals.html#g01401847e0596226eab39f1c1e2f929e">00382</a> <a class="code" href="group__DBusWatchInternals.html#g01401847e0596226eab39f1c1e2f929e">_dbus_watch_list_add_watch</a> (<a class="code" href="structDBusWatchList.html">DBusWatchList</a> *watch_list,
<a name="l00383"></a>00383                             <a class="code" href="structDBusWatch.html">DBusWatch</a>     *watch)
<a name="l00384"></a>00384 {
<a name="l00385"></a>00385   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusList.html#gd99045e79db46159babe69718f343053">_dbus_list_append</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>, watch))
<a name="l00386"></a>00386     <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00387"></a>00387   
<a name="l00388"></a>00388   <a class="code" href="group__DBusWatchInternals.html#gceda03acdda228e66a5cfe96126a919b">_dbus_watch_ref</a> (watch);
<a name="l00389"></a>00389 
<a name="l00390"></a>00390   <span class="keywordflow">if</span> (watch_list-&gt;<a class="code" href="structDBusWatchList.html#e515ab01e8d08e6b252e468be7dc7074">add_watch_function</a> != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00391"></a>00391     {
<a name="l00392"></a>00392       _dbus_verbose (<span class="stringliteral">"Adding watch on fd %"</span> <a class="code" href="group__DBusSysdeps.html#gd448c8ded79d55a3ca694d6aa9fa24cb">DBUS_POLLABLE_FORMAT</a> <span class="stringliteral">"\n"</span>,
<a name="l00393"></a>00393                      _dbus_pollable_printable (watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>));
<a name="l00394"></a>00394       
<a name="l00395"></a>00395       <span class="keywordflow">if</span> (!(* watch_list-&gt;<a class="code" href="structDBusWatchList.html#e515ab01e8d08e6b252e468be7dc7074">add_watch_function</a>) (watch,
<a name="l00396"></a>00396                                                watch_list-&gt;<a class="code" href="structDBusWatchList.html#767770241baf8ddcdb4b5c4b4f2a9727">watch_data</a>))
<a name="l00397"></a>00397         {
<a name="l00398"></a>00398           <a class="code" href="group__DBusList.html#gd93f1fc853914144e94fc7a7dc0945aa">_dbus_list_remove_last</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>, watch);
<a name="l00399"></a>00399           <a class="code" href="group__DBusWatchInternals.html#gdd0e6a682b67e470bdb77f2c8da5baea">_dbus_watch_unref</a> (watch);
<a name="l00400"></a>00400           <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00401"></a>00401         }
<a name="l00402"></a>00402     }
<a name="l00403"></a>00403   
<a name="l00404"></a>00404   <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00405"></a>00405 }
<a name="l00406"></a>00406 
<a name="l00414"></a>00414 <span class="keywordtype">void</span>
<a name="l00415"></a><a class="code" href="group__DBusWatchInternals.html#gea34537c3e5604b89fbb3f0d4c07aa9b">00415</a> <a class="code" href="group__DBusWatchInternals.html#gea34537c3e5604b89fbb3f0d4c07aa9b">_dbus_watch_list_remove_watch</a>  (<a class="code" href="structDBusWatchList.html">DBusWatchList</a> *watch_list,
<a name="l00416"></a>00416                                 <a class="code" href="structDBusWatch.html">DBusWatch</a>     *watch)
<a name="l00417"></a>00417 {
<a name="l00418"></a>00418   <span class="keywordflow">if</span> (!<a class="code" href="group__DBusList.html#g202e6ac8ad3e4a9d4413e0248ffcf3e3">_dbus_list_remove</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>, watch))
<a name="l00419"></a>00419     <a class="code" href="group__DBusInternalsUtils.html#g0c4961ec784874f1b1f3aeccea8d3da1">_dbus_assert_not_reached</a> (<span class="stringliteral">"Nonexistent watch was removed"</span>);
<a name="l00420"></a>00420   
<a name="l00421"></a>00421   <span class="keywordflow">if</span> (watch_list-&gt;<a class="code" href="structDBusWatchList.html#3b4b6c6d8aeb77d9b08404575e0b805a">remove_watch_function</a> != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00422"></a>00422     {
<a name="l00423"></a>00423       _dbus_verbose (<span class="stringliteral">"Removing watch on fd %"</span> <a class="code" href="group__DBusSysdeps.html#gd448c8ded79d55a3ca694d6aa9fa24cb">DBUS_POLLABLE_FORMAT</a> <span class="stringliteral">"\n"</span>,
<a name="l00424"></a>00424                      _dbus_pollable_printable (watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>));
<a name="l00425"></a>00425       
<a name="l00426"></a>00426       (* watch_list-&gt;<a class="code" href="structDBusWatchList.html#3b4b6c6d8aeb77d9b08404575e0b805a">remove_watch_function</a>) (watch,
<a name="l00427"></a>00427                                              watch_list-&gt;<a class="code" href="structDBusWatchList.html#767770241baf8ddcdb4b5c4b4f2a9727">watch_data</a>);
<a name="l00428"></a>00428     }
<a name="l00429"></a>00429   
<a name="l00430"></a>00430   <a class="code" href="group__DBusWatchInternals.html#gdd0e6a682b67e470bdb77f2c8da5baea">_dbus_watch_unref</a> (watch);
<a name="l00431"></a>00431 }
<a name="l00432"></a>00432 
<a name="l00441"></a>00441 <span class="keywordtype">void</span>
<a name="l00442"></a><a class="code" href="group__DBusWatchInternals.html#g14bb50e8663a1d9d3960b4f73c09c097">00442</a> <a class="code" href="group__DBusWatchInternals.html#g14bb50e8663a1d9d3960b4f73c09c097">_dbus_watch_list_toggle_watch</a> (<a class="code" href="structDBusWatchList.html">DBusWatchList</a>           *watch_list,
<a name="l00443"></a>00443                                <a class="code" href="structDBusWatch.html">DBusWatch</a>               *watch,
<a name="l00444"></a>00444                                <a class="code" href="group__DBusTypes.html#g39c9cb0f3a2a8ad6f55cc4855d035349">dbus_bool_t</a>              enabled)
<a name="l00445"></a>00445 {
<a name="l00446"></a>00446   enabled = !!enabled;
<a name="l00447"></a>00447   
<a name="l00448"></a>00448   <span class="keywordflow">if</span> (enabled == watch-&gt;<a class="code" href="structDBusWatch.html#010564b43e0c7dd438b9ac4b0c1dbe64">enabled</a>)
<a name="l00449"></a>00449     <span class="keywordflow">return</span>;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451   watch-&gt;<a class="code" href="structDBusWatch.html#010564b43e0c7dd438b9ac4b0c1dbe64">enabled</a> = enabled;
<a name="l00452"></a>00452   
<a name="l00453"></a>00453   <span class="keywordflow">if</span> (watch_list-&gt;<a class="code" href="structDBusWatchList.html#ed21ba690eb810c4c2da581feaed822a">watch_toggled_function</a> != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00454"></a>00454     {
<a name="l00455"></a>00455       _dbus_verbose (<span class="stringliteral">"Toggling watch %p on fd %"</span> <a class="code" href="group__DBusSysdeps.html#gd448c8ded79d55a3ca694d6aa9fa24cb">DBUS_POLLABLE_FORMAT</a> <span class="stringliteral">" to %d\n"</span>,
<a name="l00456"></a>00456                      watch,
<a name="l00457"></a>00457                      _dbus_pollable_printable (watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>),
<a name="l00458"></a>00458                      watch-&gt;<a class="code" href="structDBusWatch.html#010564b43e0c7dd438b9ac4b0c1dbe64">enabled</a>);
<a name="l00459"></a>00459       
<a name="l00460"></a>00460       (* watch_list-&gt;<a class="code" href="structDBusWatchList.html#ed21ba690eb810c4c2da581feaed822a">watch_toggled_function</a>) (watch,
<a name="l00461"></a>00461                                               watch_list-&gt;<a class="code" href="structDBusWatchList.html#767770241baf8ddcdb4b5c4b4f2a9727">watch_data</a>);
<a name="l00462"></a>00462     }
<a name="l00463"></a>00463 }
<a name="l00464"></a>00464 
<a name="l00472"></a>00472 <span class="keywordtype">void</span>
<a name="l00473"></a><a class="code" href="group__DBusWatchInternals.html#g935ba95d94a14aee79d80abe970eae53">00473</a> <a class="code" href="group__DBusWatchInternals.html#g935ba95d94a14aee79d80abe970eae53">_dbus_watch_list_toggle_all_watches</a> (<a class="code" href="structDBusWatchList.html">DBusWatchList</a>           *watch_list,
<a name="l00474"></a>00474                                      <a class="code" href="group__DBusTypes.html#g39c9cb0f3a2a8ad6f55cc4855d035349">dbus_bool_t</a>              enabled)
<a name="l00475"></a>00475 {
<a name="l00476"></a>00476   <a class="code" href="structDBusList.html">DBusList</a> *link;
<a name="l00477"></a>00477 
<a name="l00478"></a>00478   <span class="keywordflow">for</span> (link = <a class="code" href="group__DBusList.html#g1e26ce4fb4acb50593bd5ed2f4eeb3ae">_dbus_list_get_first_link</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>);
<a name="l00479"></a>00479        link != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00480"></a>00480        link = <a class="code" href="group__DBusList.html#gede4ace46d5ee497d75074bfec4490a2">_dbus_list_get_next_link</a> (&amp;watch_list-&gt;<a class="code" href="structDBusWatchList.html#b4e73fc61203dd03949f0b7d163d456d">watches</a>, link))
<a name="l00481"></a>00481     {
<a name="l00482"></a>00482       <a class="code" href="group__DBusWatchInternals.html#g14bb50e8663a1d9d3960b4f73c09c097">_dbus_watch_list_toggle_watch</a> (watch_list, link-&gt;<a class="code" href="structDBusList.html#29ab457bcf9092252bb0c4282c727055">data</a>, enabled);
<a name="l00483"></a>00483     }
<a name="l00484"></a>00484 }
<a name="l00485"></a>00485 
<a name="l00498"></a>00498 <span class="keywordtype">void</span>
<a name="l00499"></a><a class="code" href="group__DBusWatchInternals.html#g75620808f4d2245914012a41e3b82f3c">00499</a> <a class="code" href="group__DBusWatchInternals.html#g75620808f4d2245914012a41e3b82f3c">_dbus_watch_set_handler</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a>        *watch,
<a name="l00500"></a>00500                          <a class="code" href="group__DBusWatchInternals.html#gcc4276cd0b01ed7c011658f164ce575a">DBusWatchHandler</a>  handler,
<a name="l00501"></a>00501                          <span class="keywordtype">void</span>             *data,
<a name="l00502"></a>00502                          <a class="code" href="group__DBusMemory.html#g8792ec2b2b8626ca28022faf51ec415a">DBusFreeFunction</a>  free_data_function)
<a name="l00503"></a>00503 {
<a name="l00504"></a>00504   <span class="keywordflow">if</span> (watch-&gt;<a class="code" href="structDBusWatch.html#64eaf9b88cebfc640bc85d0fd37184c8">free_handler_data_function</a>)
<a name="l00505"></a>00505     (* watch-&gt;<a class="code" href="structDBusWatch.html#64eaf9b88cebfc640bc85d0fd37184c8">free_handler_data_function</a>) (watch-&gt;<a class="code" href="structDBusWatch.html#e906b28caa8a4323f85c882abe901e87">handler_data</a>);
<a name="l00506"></a>00506 
<a name="l00507"></a>00507   watch-&gt;<a class="code" href="structDBusWatch.html#ad3fb97da0ad7e5897611930f7a1c3e9">handler</a> = handler;
<a name="l00508"></a>00508   watch-&gt;<a class="code" href="structDBusWatch.html#e906b28caa8a4323f85c882abe901e87">handler_data</a> = data;
<a name="l00509"></a>00509   watch-&gt;<a class="code" href="structDBusWatch.html#64eaf9b88cebfc640bc85d0fd37184c8">free_handler_data_function</a> = free_data_function;
<a name="l00510"></a>00510 }
<a name="l00511"></a>00511 
<a name="l00543"></a>00543 <span class="keywordtype">int</span>
<a name="l00544"></a><a class="code" href="group__DBusWatch.html#g62d7e86fe386ed48fb90d443b3a2ce7a">00544</a> <a class="code" href="group__DBusWatch.html#g62d7e86fe386ed48fb90d443b3a2ce7a">dbus_watch_get_fd</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00545"></a>00545 {
<a name="l00546"></a>00546   _dbus_return_val_if_fail (watch != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -1);
<a name="l00547"></a>00547 
<a name="l00548"></a>00548   <span class="keywordflow">return</span> <a class="code" href="group__DBusWatch.html#g15df7f6120ead3e09bec8a70d3c43c0d">dbus_watch_get_unix_fd</a>(watch);
<a name="l00549"></a>00549 }
<a name="l00550"></a>00550 
<a name="l00564"></a>00564 <span class="keywordtype">int</span>
<a name="l00565"></a><a class="code" href="group__DBusWatch.html#g15df7f6120ead3e09bec8a70d3c43c0d">00565</a> <a class="code" href="group__DBusWatch.html#g15df7f6120ead3e09bec8a70d3c43c0d">dbus_watch_get_unix_fd</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00566"></a>00566 {
<a name="l00567"></a>00567   _dbus_return_val_if_fail (watch != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -1);
<a name="l00568"></a>00568 
<a name="l00569"></a>00569   <span class="comment">/* FIXME remove #ifdef and do this on a lower level</span>
<a name="l00570"></a>00570 <span class="comment">   * (watch should have set_socket and set_unix_fd and track</span>
<a name="l00571"></a>00571 <span class="comment">   * which it has, and the transport should provide the</span>
<a name="l00572"></a>00572 <span class="comment">   * appropriate watch type)</span>
<a name="l00573"></a>00573 <span class="comment">   */</span>
<a name="l00574"></a>00574 <span class="preprocessor">#ifdef DBUS_UNIX</span>
<a name="l00575"></a>00575 <span class="preprocessor"></span>  <span class="keywordflow">return</span> watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>;
<a name="l00576"></a>00576 <span class="preprocessor">#else</span>
<a name="l00577"></a>00577 <span class="preprocessor"></span>  <span class="keywordflow">return</span> <a class="code" href="group__DBusWatch.html#g91308f393d41b31babda17c83833517f">dbus_watch_get_socket</a>( watch );
<a name="l00578"></a>00578 <span class="preprocessor">#endif</span>
<a name="l00579"></a>00579 <span class="preprocessor"></span>}
<a name="l00580"></a>00580 
<a name="l00593"></a>00593 <span class="keywordtype">int</span>
<a name="l00594"></a><a class="code" href="group__DBusWatch.html#g91308f393d41b31babda17c83833517f">00594</a> <a class="code" href="group__DBusWatch.html#g91308f393d41b31babda17c83833517f">dbus_watch_get_socket</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00595"></a>00595 {
<a name="l00596"></a>00596   _dbus_return_val_if_fail (watch != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, -1);
<a name="l00597"></a>00597 
<a name="l00598"></a>00598 <span class="preprocessor">#ifdef DBUS_UNIX</span>
<a name="l00599"></a>00599 <span class="preprocessor"></span>  <span class="keywordflow">return</span> watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>;
<a name="l00600"></a>00600 <span class="preprocessor">#else</span>
<a name="l00601"></a>00601 <span class="preprocessor"></span>  <span class="keywordflow">return</span> _dbus_socket_get_int (watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>);
<a name="l00602"></a>00602 <span class="preprocessor">#endif</span>
<a name="l00603"></a>00603 <span class="preprocessor"></span>}
<a name="l00604"></a>00604 
<a name="l00605"></a>00605 <a class="code" href="structDBusSocket.html">DBusSocket</a>
<a name="l00606"></a><a class="code" href="group__DBusWatchInternals.html#g3f4fb8107cc01941d91d4c4914dda115">00606</a> <a class="code" href="group__DBusWatch.html#g3f4fb8107cc01941d91d4c4914dda115">_dbus_watch_get_socket</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00607"></a>00607 {
<a name="l00608"></a>00608   <a class="code" href="structDBusSocket.html">DBusSocket</a> s;
<a name="l00609"></a>00609 
<a name="l00610"></a>00610   <a class="code" href="group__DBusInternalsUtils.html#g129c6c03f011cdc171934d5d386cc797">_dbus_assert</a> (watch != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00611"></a>00611 
<a name="l00612"></a>00612 <span class="preprocessor">#ifdef DBUS_UNIX</span>
<a name="l00613"></a>00613 <span class="preprocessor"></span>  s.<a class="code" href="structDBusSocket.html#c7379c2a5c87a9c574d1ffa362a4cf23">fd</a> = watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>;
<a name="l00614"></a>00614 <span class="preprocessor">#else</span>
<a name="l00615"></a>00615 <span class="preprocessor"></span>  s = watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>;
<a name="l00616"></a>00616 <span class="preprocessor">#endif</span>
<a name="l00617"></a>00617 <span class="preprocessor"></span>
<a name="l00618"></a>00618   <span class="keywordflow">return</span> s;
<a name="l00619"></a>00619 }
<a name="l00620"></a>00620 
<a name="l00621"></a>00621 <a class="code" href="group__DBusSysdeps.html#ge217564e8ab50848f04003d982287661">DBusPollable</a>
<a name="l00622"></a><a class="code" href="group__DBusWatchInternals.html#g552f23dc081fc9e9b2bf34956171cd71">00622</a> <a class="code" href="group__DBusWatch.html#gfa9065410068af4275c1db0ff777c18a">_dbus_watch_get_pollable</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00623"></a>00623 {
<a name="l00624"></a>00624   <a class="code" href="group__DBusInternalsUtils.html#g129c6c03f011cdc171934d5d386cc797">_dbus_assert</a> (watch != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00625"></a>00625 
<a name="l00626"></a>00626   <span class="keywordflow">return</span> watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>;
<a name="l00627"></a>00627 }
<a name="l00628"></a>00628 
<a name="l00642"></a>00642 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>
<a name="l00643"></a><a class="code" href="group__DBusWatch.html#gf172a2b1d1f82333e67cec8d99c9204a">00643</a> <a class="code" href="group__DBusWatch.html#gf172a2b1d1f82333e67cec8d99c9204a">dbus_watch_get_flags</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00644"></a>00644 {
<a name="l00645"></a>00645   _dbus_return_val_if_fail (watch != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);
<a name="l00646"></a>00646   <a class="code" href="group__DBusInternalsUtils.html#g129c6c03f011cdc171934d5d386cc797">_dbus_assert</a> ((watch-&gt;<a class="code" href="structDBusWatch.html#7f1c2c609410f58a2328681c2893f70a">flags</a> &amp; VALID_WATCH_FLAGS) == watch-&gt;<a class="code" href="structDBusWatch.html#7f1c2c609410f58a2328681c2893f70a">flags</a>);
<a name="l00647"></a>00647 
<a name="l00648"></a>00648   <span class="keywordflow">return</span> watch-&gt;<a class="code" href="structDBusWatch.html#7f1c2c609410f58a2328681c2893f70a">flags</a>;
<a name="l00649"></a>00649 }
<a name="l00650"></a>00650 
<a name="l00658"></a>00658 <span class="keywordtype">void</span>*
<a name="l00659"></a><a class="code" href="group__DBusWatch.html#g8dcdbd07f15a56207af4a36cb005da77">00659</a> <a class="code" href="group__DBusWatch.html#g8dcdbd07f15a56207af4a36cb005da77">dbus_watch_get_data</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00660"></a>00660 {
<a name="l00661"></a>00661   _dbus_return_val_if_fail (watch != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00662"></a>00662 
<a name="l00663"></a>00663   <span class="keywordflow">return</span> watch-&gt;<a class="code" href="structDBusWatch.html#71877a39d8c2a7d533c0c6f280648d53">data</a>;
<a name="l00664"></a>00664 }
<a name="l00665"></a>00665 
<a name="l00677"></a>00677 <span class="keywordtype">void</span>
<a name="l00678"></a><a class="code" href="group__DBusWatch.html#g5c75a65cf0680956cc0188d86a05cfae">00678</a> <a class="code" href="group__DBusWatch.html#g5c75a65cf0680956cc0188d86a05cfae">dbus_watch_set_data</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a>        *watch,
<a name="l00679"></a>00679                      <span class="keywordtype">void</span>             *data,
<a name="l00680"></a>00680                      <a class="code" href="group__DBusMemory.html#g8792ec2b2b8626ca28022faf51ec415a">DBusFreeFunction</a>  free_data_function)
<a name="l00681"></a>00681 {
<a name="l00682"></a>00682   _dbus_return_if_fail (watch != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00683"></a>00683 
<a name="l00684"></a>00684   _dbus_verbose (<span class="stringliteral">"Setting watch fd %"</span> <a class="code" href="group__DBusSysdeps.html#gd448c8ded79d55a3ca694d6aa9fa24cb">DBUS_POLLABLE_FORMAT</a> <span class="stringliteral">" data to data = %p function = %p from data = %p function = %p\n"</span>,
<a name="l00685"></a>00685                  _dbus_pollable_printable (watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>),
<a name="l00686"></a>00686                  data, free_data_function, watch-&gt;<a class="code" href="structDBusWatch.html#71877a39d8c2a7d533c0c6f280648d53">data</a>, watch-&gt;<a class="code" href="structDBusWatch.html#d848cbd636518fd346039d0d771ba021">free_data_function</a>);
<a name="l00687"></a>00687   
<a name="l00688"></a>00688   <span class="keywordflow">if</span> (watch-&gt;<a class="code" href="structDBusWatch.html#d848cbd636518fd346039d0d771ba021">free_data_function</a> != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00689"></a>00689     (* watch-&gt;<a class="code" href="structDBusWatch.html#d848cbd636518fd346039d0d771ba021">free_data_function</a>) (watch-&gt;<a class="code" href="structDBusWatch.html#71877a39d8c2a7d533c0c6f280648d53">data</a>);
<a name="l00690"></a>00690   
<a name="l00691"></a>00691   watch-&gt;<a class="code" href="structDBusWatch.html#71877a39d8c2a7d533c0c6f280648d53">data</a> = data;
<a name="l00692"></a>00692   watch-&gt;<a class="code" href="structDBusWatch.html#d848cbd636518fd346039d0d771ba021">free_data_function</a> = free_data_function;
<a name="l00693"></a>00693 }
<a name="l00694"></a>00694 
<a name="l00702"></a>00702 <a class="code" href="group__DBusTypes.html#g39c9cb0f3a2a8ad6f55cc4855d035349">dbus_bool_t</a>
<a name="l00703"></a><a class="code" href="group__DBusWatch.html#ge7a91e6d4d1bc187419c47c522e33a8f">00703</a> <a class="code" href="group__DBusWatch.html#ge7a91e6d4d1bc187419c47c522e33a8f">dbus_watch_get_enabled</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a> *watch)
<a name="l00704"></a>00704 {
<a name="l00705"></a>00705   _dbus_return_val_if_fail (watch != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="group__DBusMacros.html#ga93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00706"></a>00706 
<a name="l00707"></a>00707   <span class="keywordflow">return</span> watch-&gt;<a class="code" href="structDBusWatch.html#010564b43e0c7dd438b9ac4b0c1dbe64">enabled</a>;
<a name="l00708"></a>00708 }
<a name="l00709"></a>00709 
<a name="l00710"></a>00710 
<a name="l00733"></a>00733 <a class="code" href="group__DBusTypes.html#g39c9cb0f3a2a8ad6f55cc4855d035349">dbus_bool_t</a>
<a name="l00734"></a><a class="code" href="group__DBusWatch.html#gc2acdb1794450ac01a43ec4c3e07ebf7">00734</a> <a class="code" href="group__DBusWatch.html#gc2acdb1794450ac01a43ec4c3e07ebf7">dbus_watch_handle</a> (<a class="code" href="structDBusWatch.html">DBusWatch</a>    *watch,
<a name="l00735"></a>00735                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  flags)
<a name="l00736"></a>00736 {
<a name="l00737"></a>00737   _dbus_return_val_if_fail (watch != <a class="code" href="group__DBusMacros.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="group__DBusMacros.html#ga93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00738"></a>00738 
<a name="l00739"></a>00739 <span class="preprocessor">#ifndef DBUS_DISABLE_CHECKS</span>
<a name="l00740"></a>00740 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (!_dbus_pollable_is_valid (watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>) || watch-&gt;<a class="code" href="structDBusWatch.html#7f1c2c609410f58a2328681c2893f70a">flags</a> == 0)
<a name="l00741"></a>00741     {
<a name="l00742"></a>00742       <a class="code" href="group__DBusInternalsUtils.html#g63f2f8a068454b781f214ba596e313b4">_dbus_warn_check_failed</a> (<span class="stringliteral">"Watch is invalid, it should have been removed\n"</span>);
<a name="l00743"></a>00743       <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00744"></a>00744     }
<a name="l00745"></a>00745 <span class="preprocessor">#endif</span>
<a name="l00746"></a>00746 <span class="preprocessor"></span>    
<a name="l00747"></a>00747   _dbus_return_val_if_fail (_dbus_pollable_is_valid (watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>) <span class="comment">/* fails if watch was removed */</span>, <a class="code" href="group__DBusMacros.html#ga8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00748"></a>00748   
<a name="l00749"></a>00749   <a class="code" href="group__DBusWatchInternals.html#gb8f49926fe9ee56cb4ae7c1c8071cca3">_dbus_watch_sanitize_condition</a> (watch, &amp;flags);
<a name="l00750"></a>00750 
<a name="l00751"></a>00751   <span class="keywordflow">if</span> (flags == 0)
<a name="l00752"></a>00752     {
<a name="l00753"></a>00753       _dbus_verbose (<span class="stringliteral">"After sanitization, watch flags on fd %"</span> <a class="code" href="group__DBusSysdeps.html#gd448c8ded79d55a3ca694d6aa9fa24cb">DBUS_POLLABLE_FORMAT</a> <span class="stringliteral">" were 0\n"</span>,
<a name="l00754"></a>00754                      _dbus_pollable_printable (watch-&gt;<a class="code" href="structDBusWatch.html#7c3796e9aec318ef800080eab3598cc9">fd</a>));
<a name="l00755"></a>00755       <span class="keywordflow">return</span> <a class="code" href="group__DBusMacros.html#ga8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00756"></a>00756     }
<a name="l00757"></a>00757   <span class="keywordflow">else</span>
<a name="l00758"></a>00758     <span class="keywordflow">return</span> (* watch-&gt;<a class="code" href="structDBusWatch.html#ad3fb97da0ad7e5897611930f7a1c3e9">handler</a>) (watch, flags,
<a name="l00759"></a>00759                                watch-&gt;<a class="code" href="structDBusWatch.html#e906b28caa8a4323f85c882abe901e87">handler_data</a>);
<a name="l00760"></a>00760 }
<a name="l00761"></a>00761 
<a name="l00762"></a>00762 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on 13 Sep 2016 for D-Bus by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
